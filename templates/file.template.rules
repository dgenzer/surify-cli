alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"HTTP to potenially malicious file with name {{match}}"; flow: established, to_server; content:"GET"; http_method; filename:"{{match}}"; classtype:suspicious-filename-detect; metadata: generator surify; sid: 1; rev: 1; reference: url, {{file}};)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"HTTP to potenially malicious file with name {{match}}"; flow: established, to_client; filename:"{{match}}"; classtype:suspicious-filename-detect; metadata: generator surify; sid: 1; rev: 1; reference: url, {{file}};)
alert ftp-data $HOME_NET any -> $EXTERNAL_NET any (msg:"FTP RETR of potenially malicious file with name {{match}}"; ftpdata_command:retr; filename:"{{match}}"; classtype:suspicious-filename-detect; metadata: generator surify; sid: 1; rev: 1; reference: url, {{file}};)
alert ftp-data $EXTERNAL_NET any -> $HOME_NET any (msg:"FTP STOR of potenially malicious file with name {{match}}"; ftpdata_command:stor; filename:"{{match}}"; classtype:suspicious-filename-detect; metadata: generator surify; sid: 1; rev: 1; reference: url, {{file}};)
alert ftp-data $HOME_NET any -> $HOME_NET any (msg:"FTP RETR internally of potenially malicious file with name {{match}}"; ftpdata_command:retr; filename:"{{match}}"; classtype:suspicious-filename-detect; metadata: generator surify; sid: 1; rev: 1; reference: url, {{file}};)
alert ftp-data $HOME_NET any -> $HOME_NET any (msg:"FTP STOR internally of potenially malicious file with name {{match}}"; ftpdata_command:stor; filename:"{{match}}"; classtype:suspicious-filename-detect; metadata: generator surify; sid: 1; rev: 1; reference: url, {{file}};)
alert smb $HOME_NET any -> $HOME_NET any (msg: "SMB Internal transfer of potenially malicious file with name {{match}}"; filename:"{{match}}"; classtype:suspicious-filename-detect; metadata: generator surify; sid: 1; rev: 1; reference: url, {{file}};)
alert smb $EXTERNAL_NET any -> $HOME_NET any (msg: "SMB transfer of potenially malicious file with name {{match}}"; filename:"{{match}}"; classtype:suspicious-filename-detect; metadata: generator surify; sid: 1; rev: 1; reference: url, {{file}};)
alert smtp $EXTERNAL_NET any -> $HOME_NET any (msg:"SMTP incomming with potenially malicious file with name {{match}}"; flow: established; filename:"{{match}}"; classtype:suspicious-filename-detect; metadata: generator surify; sid: 1; rev: 1; reference: url, {{file}};)
alert smtp $HOME_NET any -> $EXTERNAL_NET any (msg:"SMTP outgoing with potenially malicious file with name {{match}}"; flow: established; filename:"{{match}}"; classtype:suspicious-filename-detect; metadata: generator surify; sid: 1; rev: 1; reference: url, {{file}};)