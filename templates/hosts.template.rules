alert dns $HOME_NET any -> $EXTERNAL_NET any (msg:"DNS Request for potenially malicious domain {{match}}"; flow: established, to_server; dns_query; content:"{{match}}"; classtype: targeted-activity;  metadata: generator surify; sid: 1; rev: 1; reference: url, {{file}};)
alert http $HOME_NET any -> $EXTERNAL_NET  any (msg:"HTTP Outgoing connection to potenially malicious host {{match}}"; flow: established; content:"{{match}}"; http_host; classtype: targeted-activity; metadata: generator surify; sid: 1; rev: 1; reference: url, {{file}};)
alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"TLS Outgoing connection to potenially malicious host {{match}}"; flow: established; tls_cert_subject; content:"{{match}}"; nocase; isdataat:!1,relative; classtype: targeted-activity; metadata: generator surify; sid: 1; rev: 1; reference: url, {{file}};)
alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"TLS Outgoing connection to potenially malicious host {{match}}"; flow: established; tls_sni; content:"{{match}}"; nocase; isdataat:!1,relative; classtype: targeted-activity; metadata: generator surify; sid: 1; rev: 1; reference: url, {{file}};)